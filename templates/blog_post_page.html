{% extends "base.html" %}

<!-- Content -->
{% block content %}
<script
  src="/shaders/loader.js"
  data-fragment-url="/shaders/chilly-waves.glsl"
></script>

<!-- To be able to copy the codeblocks -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".blog-post-content pre").forEach((pre) => {
      const code = pre.querySelector("code");
      if (!code) return;

      pre.style.position = "relative";

      const copy_button = document.createElement("button");
      copy_button.className = "copy-button";
      copy_button.type = "button";
      copy_button.innerText = "â§‰";

      const tooltip = document.createElement("span");
      tooltip.className = "copy-tooltip";
      tooltip.innerText = "Copied";

      pre.appendChild(copy_button);
      pre.appendChild(tooltip);

      const copy_to_clipboard = async () => {
        try {
          await navigator.clipboard.writeText(
            code.textContent.substring(0, code.textContent.length - 1),
          );
          tooltip.innerText = "Copied";
        } catch (err) {
          tooltip.innerText = "Can't copy to clipboard";
          console.log(err);
        }

        tooltip.classList.add("show");
        setTimeout(() => tooltip.classList.remove("show"), 1200);
      };

      copy_button.addEventListener("click", (e) => {
        e.stopPropagation();
        copy_to_clipboard();
      });

      code.addEventListener("click", (e) => {
        e.stopPropagation();
        copy_to_clipboard();
      });
    });

    document.querySelectorAll(".blog-post-content code").forEach((code) => {
      if (code.closest("pre")) return;

      code.addEventListener("click", (e) => {
        e.stopPropagation();
        navigator.clipboard.writeText(
          code.textContent.substring(0, code.textContent.length - 1),
        );
      });
    });
  });
</script>

<div class="blog-post-page">
  <div class="top-bar">
    <a href="../" class="top-bar-left" title="Go back">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="40"
        height="40"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-back"
      >
        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
        <path d="M9 11l-4 4l4 4m-4 -4h11a4 4 0 0 0 0 -8h-1" />
      </svg>
    </a>

    <div class="font-size-big top-bar-center">{{ page.title }}</div>

    <div class="top-bar-right"></div>
  </div>

  <div class="blog-post-content">{{ page.content | safe }}</div>
</div>

{% endblock content %}
